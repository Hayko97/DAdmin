@page "/"
@using LegalEntity = Esel.Accounts.DataAccess.Entities.LegalEntity
@using DAdmin.Components.Components.Charts.ViewModels
@using DAdmin.Components.Components.Charts.Enums
@using DAdmin.Components.Components.Menus.ViewModels
@using Blazorise.DataGrid
@using Esel.Accounts.DataAccess.Entities.Transaction

@* <AdminPanel> *@
@*     <MenuItem Name="Transactions" MenuSection="MenuSection.Resources" IconClass="fa fa-table"> *@
@*         <DataResource TEntity="Transaction" ResourceName="Transactions" ExcludedProperties="@(new[] { "Status", "Username" })"> *@
@*             <Aggregator TEntity="Transaction" AggregationSelector="x => x.Amount" Aggregate="DataGridAggregateType.Sum"/> *@
@*         </DataResource> *@
@*     </MenuItem> *@
@* </AdminPanel> *@

<AdminPanel UseContextEntities="true">
    <MenuItem Name="Transactions" MenuSection="MenuSection.Resources" IconClass="fa fa-table">
        <DataResource TEntity="Transaction" ResourceName="Transactions" ExcludedProperties="@(new[] { "Status", "Username" })">
            <Aggregator TEntity="Transaction" AggregationSelector="x => x.Amount" Aggregate="DataGridAggregateType.Sum"/>
        </DataResource>
        <TimeChart TEntity="Transaction"
                   Name="Transaction Activity"
                   ChartType="ChartType.Line"
                   AggregationType="AggregationType.Count"
                   AggregationSelector="entity => entity.Id"
                   LabelSelector="entity => entity.CreatedAt"
                   TimeInterval="ChartTimeInterval.Monthly"
                   QueryLogic="query => query"/>
    </MenuItem>
    <MenuItem Name="Legal Entity" MenuSection="MenuSection.Charts" IconClass="fa fa-table">
        <DataResource TEntity="LegalEntity" ExcludedProperties="@(new[] { "Status", "Username" })">
            <Aggregates>
                <Aggregator TEntity="LegalEntity" AggregationSelector="@(x => x.Zip)" Aggregate="DataGridAggregateType.Max" />
            </Aggregates>
        </DataResource>
    </MenuItem>
</AdminPanel>

@* $1$Default Admin panel#1# *@
@* <AdminPanel/> *@

@code{

    private List<IChart> charts = new List<IChart>
    {
        new Chart<LegalEntity>
        {
            Name = "Legal Resources",
            ChartType = ChartType.Line,
            AggregationType = AggregationType.Count,
            AggregationSelector = entity => entity.Id,
            LabelSelector = entity => entity.ModifiedAt.Value,
            TimeInterval = ChartTimeInterval.Monthly,
            QueryLogic = query => query
        }
    };

}